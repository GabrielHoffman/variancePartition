<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Additional visualizations of variance structure â€¢ variancePartition</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Additional visualizations of variance structure">
<meta property="og:description" content="variancePartition">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">variancePartition</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.21.10</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/FAQ.html">Frequently asked questions</a>
    </li>
    <li>
      <a href="../articles/additional_visualization.html">Additional visualizations of variance structure</a>
    </li>
    <li>
      <a href="../articles/dream.html">dream: Differential expression testing with linear mixed models for repeated measures</a>
    </li>
    <li>
      <a href="../articles/theory_practice_random_effects.html">Theory and practice of random effects and REML</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/GabrielHoffman/variancePartition/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="additional_visualization_files/header-attrs-2.9/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Additional visualizations of variance structure</h1>
                        <h4 class="author"><a href="http://gabrielhoffman.github.io">Gabriel Hoffman</a></h4>
            <address class="author_afil">
      <p>Icahn School of Medicine at Mount Sinai, New York</p>
<br><small class="dont-index">Source: <a href="https://github.com/GabrielHoffman/variancePartition/blob/master/vignettes/additional_visualization.Rmd"><code>vignettes/additional_visualization.Rmd</code></a></small>
      <div class="hidden name"><code>additional_visualization.Rmd</code></div>

    </address>
</div>

    
        <div class="abstract">
      <p class="abstract">Abstract</p>
      <p>The correlation structure between samples in complex study designs can be decomposed into the contribution of multiple dimensions of variation. <code>variancePartition</code> provides a statistical and visualization framework to interpret sources of variation. Here I describe a visualization of the correlation structure between samples for a single gene.<br><br>
      variancePartition v1.21.10<br> August 03, 2021 09:33:03<br></p>
    </div>
    
<p>In the example dataset described in the main vignette, samples are correlated because they can come from the same individual or the same tissue. The function  shows the correlation structure caused by each variable as well and the joint correlation structure. Figure a,b shows the correlation between samples from the same individual where (a) shows the samples sorted based on clustering of the correlation matrix and (b) shows the original order. Figure c,d shows the same type of plot except demonstrating the effect of tissue. The total correlation structure from summing individual and tissue correlation matricies is shown in a,b. The code to generate these plots is shown below.</p>
<div id="plot-variance-structure" class="section level1">
<h1 class="hasAnchor">
<a href="#plot-variance-structure" class="anchor"></a>Plot variance structure</h1>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Fit linear mixed model and examine correlation stucture</span>
<span class="co"># for one gene</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">varPartData</span><span class="op">)</span>

<span class="va">form</span> <span class="op">&lt;-</span> <span class="op">~</span> <span class="va">Age</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">Individual</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">Tissue</span><span class="op">)</span>

<span class="va">fitList</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fitVarPartModel.html">fitVarPartModel</a></span><span class="op">(</span> <span class="va">geneExpr</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>,<span class="op">]</span>, <span class="va">form</span>, <span class="va">info</span> <span class="op">)</span>

<span class="co"># focus on one gene</span>
<span class="va">fit</span> <span class="op">=</span> <span class="va">fitList</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></code></pre></div>
<div id="by-individual" class="section level2">
<h2 class="hasAnchor">
<a href="#by-individual" class="anchor"></a>By Individual</h2>
<div id="reorder-samples" class="section level3">
<h3 class="hasAnchor">
<a href="#reorder-samples" class="anchor"></a>Reorder samples</h3>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Figure 1a</span>
<span class="co"># correlation structure based on similarity within Individual</span>
<span class="co"># reorder samples based on clustering</span>
<span class="fu"><a href="../reference/plotCorrStructure.html">plotCorrStructure</a></span><span class="op">(</span> <span class="va">fit</span>, <span class="st">"Individual"</span> <span class="op">)</span></code></pre></div>
<p><img src="additional_visualization_files/figure-html/corStructa-1.png" width="672"></p>
</div>
<div id="original-order-of-samples" class="section level3">
<h3 class="hasAnchor">
<a href="#original-order-of-samples" class="anchor"></a>Original order of samples</h3>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Figure 1b</span>
<span class="co"># use original order of samples</span>
<span class="fu"><a href="../reference/plotCorrStructure.html">plotCorrStructure</a></span><span class="op">(</span> <span class="va">fit</span>, <span class="st">"Individual"</span>, reorder<span class="op">=</span><span class="cn">FALSE</span> <span class="op">)</span></code></pre></div>
<p><img src="additional_visualization_files/figure-html/corStructb-1.png" width="672"></p>
</div>
</div>
<div id="by-tissue" class="section level2">
<h2 class="hasAnchor">
<a href="#by-tissue" class="anchor"></a>By Tissue</h2>
<div id="reorder-samples-1" class="section level3">
<h3 class="hasAnchor">
<a href="#reorder-samples-1" class="anchor"></a>Reorder samples</h3>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Figure 1c</span>
<span class="co"># correlation structure based on similarity within Tissue</span>
<span class="co"># reorder samples based on clustering</span>
<span class="fu"><a href="../reference/plotCorrStructure.html">plotCorrStructure</a></span><span class="op">(</span> <span class="va">fit</span>, <span class="st">"Tissue"</span> <span class="op">)</span></code></pre></div>
<p><img src="additional_visualization_files/figure-html/corStructc-1.png" width="672"></p>
</div>
<div id="original-order-of-samples-1" class="section level3">
<h3 class="hasAnchor">
<a href="#original-order-of-samples-1" class="anchor"></a>Original order of samples</h3>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Figure 1d</span>
<span class="co"># use original order of samples</span>
<span class="fu"><a href="../reference/plotCorrStructure.html">plotCorrStructure</a></span><span class="op">(</span> <span class="va">fit</span>, <span class="st">"Tissue"</span>, reorder<span class="op">=</span><span class="cn">FALSE</span> <span class="op">)</span></code></pre></div>
<p><img src="additional_visualization_files/figure-html/corStructd-1.png" width="672"></p>
</div>
</div>
<div id="by-individual-and-tissue" class="section level2">
<h2 class="hasAnchor">
<a href="#by-individual-and-tissue" class="anchor"></a>By Individual and Tissue</h2>
<div id="reorder-samples-2" class="section level3">
<h3 class="hasAnchor">
<a href="#reorder-samples-2" class="anchor"></a>Reorder samples</h3>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Figure 2a</span>
<span class="co"># correlation structure based on similarity within </span>
<span class="co"># Individual *and* Tissue, reorder samples based on clustering</span>
<span class="fu"><a href="../reference/plotCorrStructure.html">plotCorrStructure</a></span><span class="op">(</span> <span class="va">fit</span> <span class="op">)</span></code></pre></div>
<p><img src="additional_visualization_files/figure-html/corStructe-1.png" width="672"></p>
</div>
<div id="original-order-of-samples-2" class="section level3">
<h3 class="hasAnchor">
<a href="#original-order-of-samples-2" class="anchor"></a>Original order of samples</h3>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Figure 2b</span>
<span class="co"># use original order of samples</span>
<span class="fu"><a href="../reference/plotCorrStructure.html">plotCorrStructure</a></span><span class="op">(</span> <span class="va">fit</span>, reorder<span class="op">=</span><span class="cn">FALSE</span> <span class="op">)</span></code></pre></div>
<p><img src="additional_visualization_files/figure-html/corStructf-1.png" width="672"></p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Gabriel Hoffman.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
